---
title: Вопросы и ответы
description: Найдите ответы на часто задаваемые вопросы о подсистеме Windows для Linux, например о том, что можно сделать с помощью WSL.
keywords: BashOnWindows, bash, wsl, windows, windowssubsystem, часто задаваемые вопросы
ms.date: 9/4/2018
ms.topic: article
ms.assetid: 129101ed-b88a-43c2-b6a2-cd2c4ff6fee1
ms.localizationpriority: high
ms.openlocfilehash: 9a9f287ceb2ae93286999ed32d655198c8a390c8
ms.sourcegitcommit: fb79750bd71d6ebaed5203b3de71ba85a67227b1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2020
ms.locfileid: "88866151"
---
# <a name="frequently-asked-questions-about-windows-subsystem-for-linux"></a>Часто задаваемые вопросы о подсистеме Windows для Linux

## <a name="what-is-windows-subsystem-for-linux-wsl"></a>Что такое подсистема Windows для Linux (WSL)?

Подсистема Windows для Linux (WSL) — это новый компонент Windows 10, который позволяет запускать собственные программы командной строки Linux непосредственно в Windows, как классические приложения для Windows и современные приложения Store.

Чтобы узнать больше, ознакомьтесь со [страницей сведений](./about.md).

## <a name="who-is-wsl-for"></a>Для кого предназначена WSL?

В первую очередь, этот инструмент предназначен для разработчиков, особенно для веб-разработчиков и тех, кто работает над проектами с открытым кодом или участвует в них. Это позволяет всем, кто хочет использовать Bash, общие инструменты Linux (`sed`, `awk` и т. д.) и многие специализированные инструменты Linux (Ruby, Python и т. д.), пользоваться своей цепочкой инструментов в Windows.

## <a name="what-can-i-do-with-wsl"></a>Что можно сделать с помощью WSL?

WSL предоставляет приложение Bash.exe, которое при запуске открывает консоль Windows, в которой выполняется оболочка Bash. С помощью Bash можно запускать программы командной строки и приложения Linux. Например, введите `lsb_release -a` и нажмите клавишу ВВОД. Вы увидите сведения о текущем запущенном дистрибутиве Linux.

![Снимок экрана со сведениями о дистрибутиве](media/distro.png)

Вы можете также получить доступ к файловой системе локального компьютера из оболочки Bash в Linux — ваши локальные диски будут подключены в папке `/mnt`. Например, диск `C:` подключается в `/mnt/c`.  

![Снимок экрана подключенного диска C](media/ls.png)

## <a name="could-you-describe-a-typical-development-workflow-that-incorporates-wsl"></a>Опишите типичный рабочий процесс разработки с использованием WSL

Подсистема WSL нацелена на аудиторию разработчиков и предназначена для использования в рамках внутреннего цикла разработки. Предположим, Семен создает конвейер CI/CD (непрерывной интеграции и непрерывной поставки) и хочет сначала протестировать его на локальном компьютере (ноутбуке) перед развертыванием в облаке. Семен может включить WSL (а также WSL 2, чтобы повысить скорость и производительность), а затем использовать подлинный экземпляр Linux Ubuntu на локальном компьютере (ноутбуке) с любыми командами Bash и инструментами по своему выбору. После проверки конвейера разработки в локальной среде Семен может отправить этот конвейер CI/CD в облако (т. е. в Azure), сделав его контейнером Docker и отправив в облачный экземпляр, где он будет выполняться на рабочей виртуальной машине Ubuntu.

## <a name="what-is-bash"></a>Что такое Bash?

[Bash](https://en.wikipedia.org/wiki/Bash_%28Unix_shell%29) — это популярная текстовая оболочка и язык команд. Это оболочка по умолчанию, входящая в состав Ubuntu и других дистрибутивов Linux, а также в macOS. Пользователи могут вводить команды в оболочке для выполнения сценариев и (или) команд и инструментов, чтобы выполнять множество задач.

## <a name="how-does-this-work"></a>Как это работает?

Ознакомьтесь с нашим [блогом](https://blogs.msdn.microsoft.com/wsl/), где мы подробно рассматриваем базовую технологию.

## <a name="why-would-i-use-wsl-rather-than-linux-in-a-vm"></a>Зачем использовать WSL вместо Linux в виртуальной машине?

WSL требует меньше ресурсов (ЦП, памяти и хранилища), чем полноценная виртуальная машина. WSL также позволяет запускать программы командной строки и приложения Linux вместе с приложениями командной строки, классическими приложениями и приложениями Store для Windows, а также позволяет обращаться к файлам Windows в Linux. Это позволяет использовать приложения для Windows и программы командной строки Linux для одного и того же набора файлов, если требуется.

## <a name="why-would-i-use-for-example-ruby-on-linux-instead-of-on-windows"></a>Зачем использовать, например, Ruby в Linux, а не Ruby в Windows?

Некоторые кроссплатформенные инструменты были созданы, исходя из предположения, что среда, в которой они выполняются, работает как Linux. Например, некоторые инструменты предполагают, что имеют доступ к очень длинным путям к файлам или что существуют определенные файлы и папки. Это часто вызывает проблемы в среде Windows, которая нередко ведет себя иначе, чем в Linux.

Многие языки, такие как Ruby и Node, часто переносятся в Windows и работают отлично. Тем не менее, не все владельцы библиотек Ruby Gem или node/NPM переносят свои библиотеки для поддержки Windows, и многие из них имеют зависимости, относящиеся к Linux. Это часто может привести к тому, что системы, созданные с помощью таких инструментов и библиотек, становятся подвержены ошибкам во время сборки, а иногда — во время выполнения, либо не работают в Windows требуемым образом.

Это лишь часть проблем, из-за которых многие пользователи просят корпорацию Майкрософт улучшить программы командной строки Windows, а мы стали партнерами с Canonical, чтобы обеспечить выполнение собственных программ командной строки Linux и Bash в Windows.

## <a name="what-does-this-mean-for-powershell"></a>Что это означает для PowerShell?

При работе с проектами OSS существует множество сценариев, в которых чрезвычайно полезно перейти в Bash из командной строки PowerShell. Поддержка Bash дополняет и расширяет возможности командной строки в Windows, позволяя использовать PowerShell, а сообществу PowerShell — применять другие популярные технологии.

Дополнительные сведения см. в блоге группы разработчиков PowerShell: [Bash for Windows: Why it’s awesome and what it means for PowerShell](https://blogs.msdn.microsoft.com/powershell/2016/04/01/bash-for-windows-why-its-awesome-and-what-it-means-for-powershell/) (Bash для Windows: почему это здорово и что это значит для PowerShell)

## <a name="can-i-run-all-linux-apps-in-wsl"></a>Можно ли запускать ВСЕ приложения Linux в WSL?

Нет. WSL — это инструмент, предназначенный для того, чтобы позволить пользователям запускать необходимые основные программы командной строки Linux и Bash в Windows.

WSL **не** предназначен для поддержки рабочих столов или приложений с графическим пользовательским интерфейсом (например, GNOME, KDE и т. д.).  

Кроме того, хотя вы сможете запускать многие популярные серверные приложения (например, Redis), мы не рекомендуем применять WSL для размещения рабочих служб. Корпорация Майкрософт предлагает ряд других решений для запуска производственных рабочих нагрузок Linux в Azure, Hyper-V и Docker. 

## <a name="what-windows-skus-is-wsl-included-in"></a>Какие номера SKU Windows входят в WSL?

Подсистема Windows для Linux доступна для юбилейного обновления Windows 10 и Windows 10 Creators Update для настольных компьютеров (а также для более поздних версий).

Начиная с версии Fall Creators Update компонент WSL будет доступен как для номеров SKU настольных компьютеров, так и для номеров SKU серверных продуктов Windows.

## <a name="what-processors-does-wsl-support"></a>Какие процессоры поддерживает WSL?

WSL поддерживает процессоры x64 и ARM.

## <a name="how-do-i-access-my-c-drive"></a>Как получить доступ к моему диску C?

Точки подключения для жестких дисков на локальном компьютере создаются автоматически и обеспечивают простой доступ к файловой системе Windows.

**/mnt/\<drive letter>/**

Пример использования — команда `cd /mnt/c` для доступа к диску C:\

## <a name="how-do-i-set-up-git-credential-manager-how-do-i-use-my-windows-git-permissions-in-wsl"></a>Как настроить диспетчер учетных данных Git? (Как использовать разрешения Windows Git в WSL?) 

Диспетчер учетных данных Git позволяет выполнять проверку подлинности на удаленном сервере Git, даже если используется сложная модель проверки подлинности, например Azure Active Directory или двухфакторная проверка подлинности. Диспетчер учетных данных Git интегрируется в поток проверки подлинности для таких служб, как GitHub, и после проверки подлинности в поставщике услуг размещения запрашивает новый маркер проверки подлинности. Затем маркер сохраняется в диспетчере учетных данных Windows с поддержкой высокого уровня безопасности. В дальнейшем диспетчер учетных данных Git можно использовать для взаимодействия с поставщиком услуг размещения без повторной проверки подлинности. Он просто обратится к маркеру в диспетчере учетных данных Windows.

Чтобы настроить диспетчер учетных данных Git для использования с дистрибутивом WSL, откройте дистрибутив и введите такую команду:

```Bash
git config --global credential.helper "/mnt/c/Program\ Files/Git/mingw64/libexec/git-core/git-credential-manager.exe"
```

Теперь при всех операциях Git, выполняемых в дистрибутиве WSL, будет использоваться диспетчер учетных данных. Если у вас уже есть кэшированные учетные данные для узла, к ним будет выполняться доступ из диспетчера учетных данных. В противном случае отобразится диалоговое окно с запросом учетных данных, даже если вы работаете в консоли Linux.

Поддержка этих действий зависит от [взаимодействия между подсистемой Windows для Linux и собственно ОС Windows](https://docs.microsoft.com/windows/wsl/interop).

## <a name="how-do-i-use-a-windows-file-with-a-linux-app"></a>Как использовать файл Windows в приложении Linux?

Одним из преимуществ WSL является возможность доступа к файлам с помощью приложений или инструментов Windows и Linux. 

WSL подключает несъемные диски вашего компьютера к папке `/mnt/<drive>` в ваших дистрибутивах Linux. Например, диск `C:` подключается в `/mnt/c/`.

Используя подключенные диски, можно изменить код, например, в `C:\dev\myproj\` с помощью [Visual Studio](https://visualstudio.microsoft.com/vs/) или [VS Code](https://code.visualstudio.com/), а также выполнить сборку или тестирование этого кода в Linux, воспользовавшись этими же файлами в `/mnt/c/dev/myproj`.

> **Важное примечание.** Одним из основных ограничений использования WSL является то, что непосредственный доступ и изменение файлов в файловой системе дистрибутивов Linux с помощью приложений или инструментов Windows не поддерживается. См. раздел [Не изменяйте файлы Linux с помощью приложений и инструментов Windows](https://blogs.msdn.microsoft.com/commandline/2016/11/17/do-not-change-linux-files-using-windows-apps-and-tools/)

## <a name="are-files-in-the-linux-drive-different-from-the-mounted-windows-drive"></a>Отличаются ли файлы на диске Linux от файлов на подключенном диске Windows?

1. Файлы в корне Linux (т. е. `/`) контролируются подсистемой WSL, которая имитирует поведение Linux, включая, помимо прочего, следующее:
   * файлы, содержащие в имени файла недопустимые знаки для Windows;
   * символические ссылки, созданные для пользователей без прав администратора;
   * изменение атрибутов файла с помощью chmod и chown;
   * учет регистра в именах файлов и папок.

2. Файлы на подключенных дисках контролируются Windows и имеют следующие характеристики:
   * поддерживают учет регистра;
   * все разрешения заданы для наилучшего отражения разрешений Windows.

## <a name="why-are-there-so-many-errors-when-i-run-apt-get-upgrade"></a>Почему при выполнении apt-get upgrade возникает много ошибок?

Некоторые пакеты используют функции, которые еще не реализованы. Например, `udev`пока не поддерживается и вызывает несколько ошибок `apt-get upgrade`.

Чтобы устранить проблемы, связанные с `udev`, выполните следующие действия.

1. Введите приведенный ниже код в `/usr/sbin/policy-rc.d` и сохраните изменения.

    ```bash
    #!/bin/sh
    exit 101
    ```

2. Добавьте разрешения на выполнение в `/usr/sbin/policy-rc.d`

    ```bash
    chmod +x /usr/sbin/policy-rc.d
    ```
  
3. Выполните следующие команды.

    ```bash
    dpkg-divert --local --rename --add /sbin/initctl
    ln -s /bin/true /sbin/initctl
    ```

## <a name="how-do-i-uninstall-a-wsl-distribution"></a>Как удалить дистрибутив WSL?

В сборках, предшествующих сборке 1709 (16299), откройте командную строку и выполните следующую команду.

  ```batchfile
  lxrun /uninstall /full
  ```
  
Дистрибутивы WSL, установленные из Store, можно удалить как и любое другое приложение Windows. Для этого щелкните плитку приложения правой кнопкой мыши и выберите "Удалить". Можно также воспользоваться PowerShell и выполнить [`Remove-AppxPackage` командлет ](https://technet.microsoft.com/library/hh856038.aspx).

## <a name="why-does-ping-generate-permission-denied-errors"></a>Почему проверка связи порождает создает ошибки "Отказ в разрешении"?

В сборках WSL, предшествующих сборке 14926, для проверки связи нужно запустить WSL из консоли с повышенными привилегиями. Эта проблема была устранена в сборке 14926 и более поздних сборках.

## <a name="how-do-i-run-an-openssh-server"></a>Как запустить сервер OpenSSH?

Для запуска OpenSSH в WSL требуются привилегии администратора в Windows. Чтобы запустить сервер OpenSSH, запустите Bash для Ubuntu в Windows от имени администратора или запустите bash.exe из командной строки или сеанса PowerShell с привилегиями администратора.

## <a name="why-do-i-get-error-0x80040306-when-i-try-to-install"></a>Почему при попытке установки появляется сообщение "Ошибка:0x80040306"?

WSL не поддерживает выполнение в устаревшей консоли. Чтобы отключить устаревшую консоль, выполните следующие действия.

1. Откройте WSL, PowerShell или командную строку.
1. Щелкните правой кнопкой мыши строку заголовка и выберите "Свойства", затем снимите флажок "Использовать прежнюю версию консоли".
1. Нажмите кнопку "ОК".

## <a name="why-do-i-get-error-0x80040154-when-i-run-bashexe-after-upgrading-windows"></a>Почему при запуске bash.exe после обновления Windows появляется сообщение "Ошибка: 0x80040154"?

Компонент "Подсистема Windows для Linux" может быть отключен во время обновления Windows. В этом случае данную функцию Windows необходимо включить заново. Инструкции по включению компонента "Подсистема Windows для Linux" можно найти в [руководстве по установке](https://docs.microsoft.com/windows/wsl/install-win10#install-the-windows-subsystem-for-linux).

## <a name="how-do-i-change-the-display-language-of-wsl"></a>Как изменить язык интерфейса WSL?

Установщик WSL попытается автоматически изменить языковой стандарт Ubuntu в соответствии с языковым стандартом установки Windows. Если это нежелательно, можно выполнить приведенную ниже команду, чтобы изменить языковой стандарт Ubuntu после завершения установки. Чтобы это изменение вступило в силу, потребуется повторно запустить bash.exe.

В приведенном ниже примере языковой стандарт изменяется на EN-US.

```bash
sudo update-locale LANG=en_US.UTF8
```

## <a name="why-do-i-not-have-internet-access-from-wsl"></a>Почему у меня нет доступа к Интернету из WSL?

Некоторые пользователи сообщили о проблемах с определенными приложениями брандмауэра, блокирующими доступ к Интернету в WSL. Сообщили о следующих брандмауэрах:

1. Kaspersky;
1. AVG;
1. Avast.

В некоторых случаях отключение брандмауэра обеспечивает доступ. В некоторых случаях доступ блокируется просто при наличии установленного брандмауэра.

## <a name="how-do-i-access-a-port-from-wsl-in-windows"></a>Как получить доступ к порту из WSL в Windows?
WSL использует IP-адрес Windows, так как работает в Windows. Поэтому вы можете получить доступ к любым портам на localhost. Например, если вы предоставляете веб-содержимое через порт 1234, то вы можете открыть адрес https://localhost:1234 в браузере для Windows.

## <a name="how-can-i-back-up-my-wsl-distros-or-move-them-from-one-drive-to-another"></a>Как выполнить резервное копирование дистрибутивов WSL или переместить их с одного диска на другой?

Лучший способ резервного копирования или переноса дистрибутивов — использование команд импорта и экспорта, доступных в Windows версии 1809 и более поздних версиях. Вы можете экспортировать весь дистрибутив в архив tarball с помощью команды `wsl --export`. Затем этот дистрибутив можно импортировать обратно в WSL с помощью команды `wsl --import`, которая позволяет присвоить имя новому расположению на диске для импорта. Благодаря этому можно создавать резервные копии и сохранять состояния дистрибутивов WSL или переносить дистрибутивы. 

Обратите внимание на то, что традиционные службы резервного копирования, которые создают резервные копии файлов в папках AppData (например, программа архивации данных), не повредят файлы Linux.

## <a name="where-can-i-provide-feedback"></a>Куда можно отправить отзыв?

Вы можете оставлять свои отзывы и задавать вопросы, используя несколько каналов.

Если у вас возникли технические проблемы или вы хотите запросить новые функции, перейдите к нашему средству записи проблем GitHub:

* [Средство отслеживания проблем GitHub](https://github.com/Microsoft/BashOnWindows/issues)

Если вы хотите оставаться в курсе последних новостей WSL, используйте следующее:

* в наш [блог команды разработчиков для командной строки](https://blogs.msdn.microsoft.com/commandline/);
* Twitter. подпишитесь на [@craigaloewen](https://twitter.com/craigaloewen) в Twitter, чтобы получать новости, узнавать об обновлениях и т. д.
